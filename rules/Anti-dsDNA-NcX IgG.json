{ "assay_name": "Anti-dsDNA-NcX IgG",
  "assay_key": "(661f)",
  "lot_rule": {
    "regex": "Kit\\s+(\\S+)\\s+\\d{6}"
  },
"extract_rules": {
  "fields": [
    {
      "key": "ANWENDER",
      "regex": "Anwender:\\s*([^\\s]+)",
      "required": false
    },
    {
      "key": "ZEIT",
      "regex": "Zeit:\\s*(\\d{2}:\\d{2}:\\d{2})",
      "required": false
    },
    {
      "key": "DATUM",
      "regex": "Datum:\\s*(\\d{2}\\.\\d{2}\\.\\d{4})",
      "required": false
    },
    {
      "key": "PLATTE",
      "regex": "Plattenname:\\s*(.+?)\\s+Zeit:",
      "required": false
    },

    {
      "key": "CHARGE",
      "regex": "Kit\\s+(E[0-9A-Za-z]+)\\s+\\d{6}",
      "required": false
    },
    {
      "key": "Haltbarkeit",
      "regex": "Kit\\s+E[0-9A-Za-z]+\\s+(\\d{6})",
      "required": false
    },

    {
      "key": "VALIDATION",
      "regex": "^(Validationskriterien\\s+(?:nicht\\s+)?erf√ºllt)",
      "required": false,
      "search_from": { "line": 0 }
    },

    {
      "key": "UG_PCQ1",
      "regex": "\\bPCQ1\\s+(\\d+(?:[\\.,]\\d+)?)<=PCQ1<=",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },
    {
      "key": "ZIEL_PCQ1",
      "regex": "\\bPCQ1\\s+\\d+(?:[\\.,]\\d+)?<=PCQ1<=\\d+(?:[\\.,]\\d+)?\\s+\\d+(?:[\\.,]\\d+)?<=\\s*(\\d+(?:[\\.,]\\d+)?)\\s*<=",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },
    {
      "key": "OG_PCQ1",
      "regex": "\\bPCQ1\\s+\\d+(?:[\\.,]\\d+)?<=PCQ1<=(\\d+(?:[\\.,]\\d+)?)",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },

    {
      "key": "UG_NCQ1",
      "regex": "\\bNCQ1\\s+(\\d+(?:[\\.,]\\d+)?)<=NCQ1<=",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },
    {
      "key": "ZIEL_NCQ1",
      "regex": "\\bNCQ1\\s+\\d+(?:[\\.,]\\d+)?<=NCQ1<=\\d+(?:[\\.,]\\d+)?\\s+\\d+(?:[\\.,]\\d+)?<=\\s*(\\d+(?:[\\.,]\\d+)?)\\s*<=",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },
    {
      "key": "OG_NCQ1",
      "regex": "\\bNCQ1\\s+\\d+(?:[\\.,]\\d+)?<=NCQ1<=(\\d+(?:[\\.,]\\d+)?)",
      "required": false,
      "search_from": { "after": "Validierungskriterien" }
    },

    {
      "key": "PCQ1",
      "regex": "\\bPCQ1\\b.*?\\s(\\d+(?:[\\.,]\\d+)?)\\s+RU/ml",
      "required": false
    },
    {
      "key": "NCQ1",
      "regex": "\\bNCQ1\\b.*?\\s(\\d+(?:[\\.,]\\d+)?)\\s+RU/ml",
      "required": false
    },

    {
      "key": "SOLL_S1",
      "regex": "\\bS1\\b.*?\\s(>\\s*\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },
    {
      "key": "IST_S1",
      "regex": "\\bS1\\b.*?\\s(\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },
    {
      "key": "S1_MIN",
      "regex": "\\bS1\\b.*?>\\s*(\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },

    {
      "key": "SOLL_S2",
      "regex": "\\bS2\\b.*?\\s(>\\s*\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },
    {
      "key": "IST_S2",
      "regex": "\\bS2\\b.*?\\s(\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },
    {
      "key": "S2_MIN",
      "regex": "\\bS2\\b.*?>\\s*(\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },

    {
      "key": "SOLL_S3",
      "regex": "\\bS3\\b.*?\\s(>\\s*\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },
    {
      "key": "IST_S3",
      "regex": "\\bS3\\b.*?\\s(\\d+(?:[\\.,]\\d+)?)\\s+O\\.D\\.",
      "required": false
    },

    {
      "key": "FILE_NAME",
      "regex": "__FILE_NAME_NOT_IN_TEXT__",
      "required": false
    }
  ]
},

"excel_rules": {
  "excel_filename_template": "{assay_name}.xlsx",
  "sheetname_template": "{lot_id}",
  "column_mapping": {
    "ANWENDER": "ANWENDER",
    "ZEIT": "ZEIT",
    "DATUM": "DATUM",
    "PLATTE": "PLATTE",

    "CHARGE": "CHARGE",
    "Haltbarkeit": "Haltbarkeit",

    "PCQ1": "PCQ1",
    "UG_PCQ1": "UG PCQ1",
    "ZIEL_PCQ1": "ZIEL PCQ1",
    "OG_PCQ1": "OG PCQ1",

    "NCQ1": "NCQ1",
    "UG_NCQ1": "UG NCQ1",
    "ZIEL_NCQ1": "ZIEL NCQ1",
    "OG_NCQ1": "OG NCQ1",

    "SOLL_S1": "SOLL S1",
    "IST_S1": "IST S1",
    "S1_MIN": "S1 MIN",

    "SOLL_S2": "SOLL S2",
    "S2_MIN": "S2 MIN",
    "IST_S2": "IST S2",

    "SOLL_S3": "SOLL S3",
    "IST_S3": "IST S3",

    "FILE_NAME": "FILE_NAME",
    "VALIDATION": "VALIDATION"
  }
},
  "extract_rules": {
    "fields": [
      {
        "key": "plate_name",
        "regex": "Plattenname:\\s*(.+?)\\s+Zeit:",
        "required": true
      },
      {
        "key": "date",
        "regex": "Datum:\\s*(\\d{2}\\.\\d{2}\\.\\d{4})",
        "required": true
      },
      {
        "key": "time",
        "regex": "Zeit:\\s*(\\d{2}:\\d{2}:\\d{2})",
        "required": true
      },
      {
        "key": "user",
        "regex": "Anwender:\\s*([^\\s]+)",
        "required": true
      },
      {
        "key": "test",
        "regex": "Test:\\s*(.+)",
        "required": false
      },
      {
        "key": "lot_id",
        "regex": "Kit\\s+(E[0-9A-Za-z]+)\\s+\\d{6}",
        "required": true
      },
      {
        "key": "lot_expiry_yymmdd",
        "regex": "Kit\\s+E[0-9A-Za-z]+\\s+(\\d{6})",
        "required": true
      }
    ]
  },

  "excel_rules": {
    "excel_filename_template": "{assay_name}.xlsx",
    "sheetname_template": "{lot_id}",
    "column_mapping": {
      "plate_name": "Plattenname",
      "time": "Zeit",
      "user": "Anwender",
      "date": "Datum",
      "test": "Test",
      "lot_id": "Lot",
      "lot_expiry_date": "Lot_Haltbarkeit"
    }
  }
}